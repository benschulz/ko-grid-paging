/*
 Copyright (c) 2015, Ben Schulz
 License: BSD 3-clause (http://opensource.org/licenses/BSD-3-Clause)
*/
function n(d,l){return function(e){return e}(function(e,c,g,d){function k(h,b,a){function p(){var f=m.querySelectorAll("tbody tr").length,a=m.clientHeight,f=Math.floor(a/(f||1))||d;e(q.clientHeight-(a-(a-a%f)));g(f)}function r(f){"fit"===f?a.element.classList.add("with-fitted-page-size"):a.element.classList.remove("with-fitted-page-size")}var u=t(h,b,["pageSize","desired"],["pageSize"]);h=t(h,b,["pageSize","maximum"])||50;var q,m;a.postApplyBindings(function(){q=a.element.querySelector(".ko-grid-table-scroller");
m=a.element.querySelector(".ko-grid-table")});this.p=this.maximumStepSize=c.observable(2);this.i=this.rowCount=c.pureComputed(function(){return a.data.view.filteredSize()});b={};b.k=b.desired=c.observable(u);b.t=b.maximum=c.observable(h);b.d=b.actual=c.pureComputed(function(){var a=this.b.k();"fit"===a&&(a=Math.floor(e()/g()),a=Math.max(1,a));return Math.min(this.b.t(),a)}.bind(this));this.b=this.pageSize=b;this.c=this.pageIndex=c.observable(0);this.v=this.pageCount=c.pureComputed(function(){var a=
Math.max(0,Math.floor((this.i()-1)/this.b.d()));this.c(Math.min(this.c(),a));return a+1}.bind(this));var d=a.layout.determineCellDimensions("|").height,e=c.observable(5*d),g=c.observable(d);a.layout.afterRelayout(p);a.postApplyBindings(function(){return a.data.rows.displayedSynchronized.subscribe(function(a){a&&p()})});var k=this.c.subscribe(function(b){return a.data.offset(b*this.b.d())}.bind(this)),l=this.b.d.subscribe(function(b){a.data.offset(this.c()*b);a.data.limit(b)}.bind(this));a.data.offset(this.c()*
this.b.d());a.data.limit(this.b.d());var v=this.b.k.subscribe(r);a.postApplyBindings(function(){return r(this.b.k())}.bind(this));this.dispose=function(){this.i.dispose();k.dispose();l.dispose();v.dispose()}.bind(this)}function t(h,b,a){for(var c=2;c<arguments.length;++c)for(var d=0;2>d;++d){var e=arguments[c].reduce(function(a,b){return a&&a[b]},arguments[d]);if(void 0!==e&&"object"!==typeof e)return e}}g.defineExtension("ko-grid-paging",{G:["ko-grid-toolbar"],H:function(c){return c.to("right-toolbar").append("paging",
d)},D:k});k.prototype={get __adjacentPageIndizes(){return c.pureComputed(function(){for(var c=Math.max(0,this.c()-this.p()),b=Math.min(this.v()-1,this.c()+this.p())-c+1,a=Array(b),d=0;d<b;++d)a[d]=c+d;return a}.bind(this))},get __message(){return c.pureComputed(function(){var c=this.c()*this.b.d()+1,b=Math.min(this.i(),(this.c()+1)*this.b.d());return c+"\u2013"+b+" of "+this.i()}.bind(this))},__handleClick:function(c,b){"BUTTON"===b.target.tagName&&this.c(parseInt(b.target.textContent,10)-1)}};return g.declareExtensionAlias("paging",
"ko-grid-paging")}({},l,d,'\x3c!-- ko with: extensions.paging --\x3e\n<div class="ko-grid-paging" data-bind="if: pageCount() > 1, click: __handleClick">\n    <span data-bind="text: __message"></span>\n    <button class="ko-grid-toolbar-button ko-grid-paging-button" data-bind="visible: pageIndex() - maximumStepSize() > 0">1</button>\n    <span data-bind="visible: pageIndex() - maximumStepSize() > 1">&hellip;</span>\n    <button data-bind="indexedRepeat: {\n                forEach: __adjacentPageIndizes,\n                indexedBy: function(i) { return \'\' + i; },\n                as: \'i\'\n            }"\n            data-repeat-bind="text: i() + 1, css: {\n                \'pressed\': pageIndex() == i(),\n                \'ko-grid-toolbar-button\': true,\n                \'current-page\': pageIndex() == i(),\n                \'ko-grid-paging-button\': true\n            }">\n    </button>\n    <span data-bind="visible: pageIndex() + maximumStepSize() + 2 < pageCount()">&hellip;</span>\n    <button class="ko-grid-toolbar-button ko-grid-paging-button" tabIndex="-1" data-bind="visible: pageIndex() + maximumStepSize() + 1 < pageCount(), text: pageCount">?</button>\n</div>\n\x3c!-- /ko --\x3e\n'))}
"function"===typeof define&&define.amd?define(["ko-grid","knockout","ko-data-source","ko-indexed-repeat"],n):window["ko-grid-paging"]=n(window.ko.bindingHandlers.grid,window.ko);